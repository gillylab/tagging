% plotOxygenProxy.m
%
% called from plotSeriesData.m in processSeriesData.m% J. Stewart
%
% Outside Functions Called:
%
% AUTHOR    : J. Stewart jules32@gmail.com
% DATE      : 12-Mar-2011 20:41:45
% Revision  : 1.00
% DEVELOPED : 7.9.0.529 (R2009b) OSX
% FILENAME  : plotOxygenProxy.m

Mfilename = mfilename;

% if TagTimeSeries % redundant now
%     if TagRecovered
%         SamplingRate = 1;
%     else
%         SamplingRate = 75;
%     end
% else
%     SamplingRate = 3600; %datevec(PDTs.PDTdate(3)-PDTs.PDTdate(2))
% end

%% figure out total time in OMZ, and each event duration. Do this for temperature and depth proxy.
% oxygenProxyPerc = 95;
% 
% % temperature proxy.
% if oxygenProxyPerc == 95
%     oxygenProxy = [3.6125 5.9875]; % 95th % these values determined in b_ROVCTD_stats.m % J. Stewart
% elseif oxygenProxyPerc == 90
%     oxygenProxy = [3.675 5.925]; % 90th
% end
% 
% % fig out time in omz. % old bad way, 28-Mar-2011
% oxyproxylog = TempTag >= oxygenProxy(1) & TempTag <= oxygenProxy(2);
% oxyproxycount = sum(oxyproxylog);
% oxyproxypercinOMZ = (oxyproxycount/length(oxyproxylog))*100;
% oxyproxytimeinOMZ = oxyproxycount*SamplingRate;
% oxyproxytimeinOMZ_hr = oxyproxytimeinOMZ/3600; % hours
% 
% % find lengths of time of each event in OMZ. Add it together to get total.
% oxyproxydex = find(TempTag >= oxygenProxy(1) & TempTag <= oxygenProxy(2)); % all OMZ indices of TempTag
% TempTag(oxyproxydex); % shows the temps of oxyproxydex
% oxyproxydexdiff = diff(oxyproxydex);
% oxyproxydexdiff1 = find(oxyproxydexdiff > 1); % just to see: TempTag(oxyproxydex(oxydex));
% % oxyproxydexdiff11 = diff(oxyproxydexdiff1);
% % oxyproxydexdiff111 = find(oxyproxydexdiff11 > 1); % qc. why do I need this? % because it would be crazy without it: oxydex = oxyproxydex(oxydex);
% 
% oxydex = oxyproxydexdiff1;% (oxyproxydexdiff111));
% 
% eventdur = oxyproxydex(oxydex(1))-oxyproxydex(1); % durations of events in OMZ
% for i = 2:length(oxydex) % these events will always be odd because first is the end of oxyproxydex, then will enter and leave OMZ
%     tempdex1 = oxyproxydex(oxydex(i-1)+1); % leave this +1 -1, it's important! first to make the correct index for diff1, then the correct index for oxyproxydex!!
%     tempdex2 = oxyproxydex(oxydex(i));
%     eventdur = [eventdur; tempdex2-tempdex1];
%     if i == length(oxydex) % additional end piece.
%         tempdex1 = oxyproxydex(oxydex(i)); % leave this +1 -1, it's important! first to make the correct index for diff1, then the correct index for oxyproxydex!!
%         tempdex2 = oxyproxydex(end);
%         eventdur = [eventdur; tempdex2-tempdex1];
%     end
% end
% 
% eventdurtime = eventdur*SamplingRate; % put this in seconds
% eventdurtimeinOMZ_hr = eventdurtime/3600; % hours
% totaltagtime_hr = (length(TempTag)*SamplingRate)/3600;
% eventdurpercinOMZ = (sum(eventdurtimeinOMZ_hr)/totaltagtime_hr)*100;

%% OMZ Polynomial Proxy. 

load -mat ROVoxyPOLYFIT.mat % Contains P, the solutions to the polynomial made in b_ROVCTD_stats.m.
OxygenTagProxy =  polyval(P,TempTag);
threshO = 0.5; %mL/L set this to zoom in on OMZ values.
maxPoly = 6; % 6 mL/L this is when polyvals' oxygen proxy stops being accurate.

%% Plot with oxygen: entire deployment

for p = 1%:2
    if p == 1 % entire deployment
        DATE = Seriesdate(~isnan(TempTag));
        DEPTH = DepthTag(~isnan(TempTag))*-1;
        OXY = OxygenTagProxy(~isnan(TempTag));
        maxO = 10;
        labelO = 'deployment';
        labelO2 = '';
    else % zoom into OMZ area
        DATE = Seriesdate(OxygenTagProxy<=threshO);
        DEPTH = DepthTag(OxygenTagProxy<=threshO)*-1;
        OXY = OxygenTagProxy(OxygenTagProxy<=threshO);
        maxO = threshO*1.4; % set this for OMZ area
        labelO = 'OMZ';
        labelO2 = [' <= ' num2str(threshO) ' '];
    end
    
    % plot series
    if exist('DayNight_boxes.m','file') %if the function is present the figure will have night boxes
        [x,y] = DayNight_boxes(DATE,sr/24,ss/24,get(gca,'Ylim'),0);
        figure
        set(gcf,'Position',[12   213   842   688])
        fill(x,y,[0.8 0.8 0.8], 'EdgeColor','none')
        hold on
%         plot(DATE,DEPTH, '.k', 'markersize', 15);
        scatter(DATE,DEPTH,30,OXY,'filled');
        colormap([0.400000005960464 1 1;0.319999992847443 0.959999978542328 0.959999978542328;0.240000009536743 0.920000016689301 0.920000016689301;0.159999996423721 0.879999995231628 0.879999995231628;0.0799999982118607 0.840000033378601 0.840000033378601;0 0.800000011920929 0.800000011920929;0.800000011920929 0.800000011920929 1;0.789473712444305 0.785964906215668 0.992982447147369;0.778947353363037 0.771929860115051 0.985964894294739;0.768421053886414 0.75789475440979 0.978947341442108;0.75789475440979 0.743859648704529 0.971929848194122;0.747368454933167 0.729824542999268 0.964912295341492;0.736842095851898 0.715789496898651 0.957894742488861;0.726315796375275 0.70175439119339 0.95087718963623;0.715789496898651 0.687719285488129 0.9438596367836;0.705263197422028 0.673684239387512 0.936842083930969;0.694736838340759 0.659649133682251 0.929824590682983;0.684210538864136 0.64561402797699 0.922807037830353;0.673684239387512 0.631578981876373 0.915789484977722;0.663157880306244 0.617543876171112 0.908771932125092;0.65263158082962 0.603508770465851 0.901754379272461;0.642105281352997 0.58947366476059 0.89473682641983;0.631578981876373 0.575438618659973 0.887719333171844;0.621052622795105 0.561403512954712 0.880701780319214;0.610526323318481 0.547368407249451 0.873684227466583;0.600000023841858 0.533333361148834 0.866666674613953;0.58947366476059 0.519298255443573 0.859649121761322;0.578947365283966 0.505263149738312 0.852631568908691;0.568421065807343 0.491228073835373 0.845614016056061;0.557894766330719 0.477192997932434 0.838596522808075;0.547368407249451 0.463157892227173 0.831578969955444;0.536842107772827 0.449122816324234 0.824561417102814;0.526315808296204 0.435087740421295 0.817543864250183;0.51578950881958 0.421052634716034 0.810526311397552;0.505263149738312 0.407017558813095 0.803508758544922;0.494736850261688 0.392982453107834 0.796491265296936;0.484210520982742 0.378947377204895 0.789473712444305;0.473684221506119 0.364912271499634 0.782456159591675;0.463157892227173 0.350877195596695 0.775438606739044;0.452631592750549 0.336842119693756 0.768421053886414;0.442105263471603 0.322807013988495 0.761403501033783;0.43157896399498 0.308771938085556 0.754386007785797;0.421052634716034 0.294736832380295 0.747368454933167;0.41052633523941 0.280701756477356 0.740350902080536;0.400000005960464 0.266666680574417 0.733333349227905;0.389473676681519 0.252631574869156 0.726315796375275;0.378947377204895 0.238596498966217 0.719298243522644;0.368421047925949 0.224561408162117 0.712280690670013;0.357894748449326 0.210526317358017 0.705263197422028;0.34736841917038 0.196491226553917 0.698245644569397;0.336842119693756 0.182456135749817 0.691228091716766;0.32631579041481 0.168421059846878 0.684210538864136;0.315789490938187 0.154385969042778 0.677192986011505;0.305263161659241 0.140350878238678 0.670175433158875;0.294736832380295 0.126315787434578 0.663157939910889;0.284210532903671 0.112280704081059 0.656140387058258;0.273684203624725 0.0982456132769585 0.649122834205627;0.263157904148102 0.084210529923439 0.642105281352997;0.252631574869156 0.070175439119339 0.635087728500366;0.242105260491371 0.0561403520405293 0.628070175647736;0.231578946113586 0.0421052649617195 0.62105268239975;0.221052631735802 0.0280701760202646 0.614035129547119;0.210526317358017 0.0140350880101323 0.607017576694489;0.200000002980232 0 0.600000023841858]);
%         colormap([0.839215695858002 0.909803926944733 0.850980401039124;0.72679740190506 0.822222232818604 0.754901945590973;0.614379107952118 0.734640538692474 0.658823549747467;0.501960813999176 0.647058844566345 0.562745094299316;0.389542490243912 0.559477150440216 0.466666668653488;0.27712419629097 0.471895426511765 0.37058824300766;0.164705887436867 0.384313732385635 0.274509817361832;0.701960802078247 0.780392169952393 1;0.696568667888641 0.770027995109558 1;0.691176474094391 0.759663879871368 1;0.685784339904785 0.749299705028534 1;0.680392146110535 0.738935589790344 1;0.675000011920929 0.72857141494751 1;0.669607877731323 0.71820729970932 1;0.664215683937073 0.707843124866486 1;0.658823549747467 0.697479009628296 1;0.653431415557861 0.687114834785461 1;0.648039221763611 0.676750719547272 1;0.642647087574005 0.666386544704437 1;0.637254893779755 0.656022429466248 1;0.631862759590149 0.645658254623413 1;0.626470625400543 0.635294139385223 1;0.621078431606293 0.624929964542389 1;0.615686297416687 0.614565849304199 1;0.610294103622437 0.604201674461365 1;0.604901969432831 0.593837559223175 1;0.599509835243225 0.583473384380341 1;0.594117641448975 0.573109269142151 1;0.588725507259369 0.562745094299316 1;0.583333373069763 0.552380979061127 1;0.577941179275513 0.542016804218292 1;0.572549045085907 0.531652688980103 1;0.567156851291656 0.521288514137268 1;0.561764717102051 0.510924398899078 1;0.556372582912445 0.500560224056244 1;0.550980389118195 0.490196079015732 1;0.545588254928589 0.47983193397522 1;0.540196061134338 0.469467788934708 1;0.534803926944733 0.459103643894196 1;0.529411792755127 0.448739498853683 1;0.524019598960876 0.438375353813171 1;0.518627464771271 0.428011208772659 1;0.513235330581665 0.417647063732147 1;0.507843136787415 0.407282918691635 1;0.502451002597809 0.396918773651123 1;0.497058838605881 0.386554628610611 1;0.491666674613953 0.376190483570099 1;0.486274510622025 0.365826338529587 1;0.480882376432419 0.355462193489075 1;0.475490212440491 0.345098048448563 1;0.470098048448563 0.334733903408051 1;0.464705884456635 0.324369758367538 1;0.459313720464706 0.314005613327026 1;0.453921586275101 0.303641468286514 1;0.448529422283173 0.293277323246002 1;0.443137258291245 0.28291317820549 1;0.437745094299316 0.272549033164978 1;0.432352960109711 0.262184888124466 1;0.426960796117783 0.251820743083954 1;0.421568632125854 0.241456583142281 1;0.416176468133926 0.231092438101768 1;0.410784333944321 0.220728293061256 1;0.405392169952393 0.210364148020744 1;0.400000005960464 0.200000002980232 1]);
%         colormap([0.400000005960464 1 1;0.200000002980232 1 1;0.100000001490116 0.874509811401367 0.874509811401367;0 0.749019622802734 0.749019622802734;0.115686275064945 0.596078455448151 0.54313725233078;0.23137255012989 0.443137258291245 0.337254911661148;0.192156866192818 0.384313732385635 0.290196090936661;0.161764711141586 0.341176480054855 0.252941191196442;0.131372556090355 0.298039227724075 0.215686291456223;0.100980393588543 0.254901975393295 0.178431376814842;0.0705882385373116 0.211764708161354 0.141176477074623;0.800000011920929 0.800000011920929 1;0.788461565971375 0.784615397453308 0.992307662963867;0.776923060417175 0.769230782985687 0.984615385532379;0.765384614467621 0.753846168518066 0.976923108100891;0.753846168518066 0.738461554050446 0.969230771064758;0.742307722568512 0.723076939582825 0.961538434028625;0.730769217014313 0.707692325115204 0.953846156597137;0.719230771064758 0.692307710647583 0.946153879165649;0.707692325115204 0.676923096179962 0.938461542129517;0.696153879165649 0.661538481712341 0.930769205093384;0.68461537361145 0.64615386724472 0.923076927661896;0.673076927661896 0.6307692527771 0.915384650230408;0.661538481712341 0.615384638309479 0.907692313194275;0.650000035762787 0.600000023841858 0.899999976158142;0.638461530208588 0.584615409374237 0.892307698726654;0.626923084259033 0.569230794906616 0.884615421295166;0.615384638309479 0.553846180438995 0.876923084259033;0.603846192359924 0.538461565971375 0.8692307472229;0.592307686805725 0.523076951503754 0.861538469791412;0.580769240856171 0.507692337036133 0.853846192359924;0.569230794906616 0.49230769276619 0.846153855323792;0.557692289352417 0.476923078298569 0.838461518287659;0.546153843402863 0.461538463830948 0.830769240856171;0.534615397453308 0.446153849363327 0.823076963424683;0.523076951503754 0.430769234895706 0.81538462638855;0.511538445949554 0.415384620428085 0.807692289352417;0.5 0.400000005960464 0.800000011920929;0.488461554050446 0.384615391492844 0.792307734489441;0.476923078298569 0.369230777025223 0.784615397453308;0.465384632349014 0.353846162557602 0.776923060417175;0.453846156597137 0.338461548089981 0.769230782985687;0.442307710647583 0.32307693362236 0.761538505554199;0.430769234895706 0.307692319154739 0.753846168518066;0.419230788946152 0.292307704687119 0.746153831481934;0.407692313194275 0.276923090219498 0.738461554050446;0.396153837442398 0.261538475751877 0.730769276618958;0.384615391492844 0.246153846383095 0.723076939582825;0.373076915740967 0.230769231915474 0.715384602546692;0.361538469791412 0.215384617447853 0.707692325115204;0.349999994039536 0.200000002980232 0.700000047683716;0.338461548089981 0.184615388512611 0.692307710647583;0.326923072338104 0.169230774044991 0.68461537361145;0.31538462638855 0.15384615957737 0.676923096179962;0.303846150636673 0.138461545109749 0.669230818748474;0.292307704687119 0.123076923191547 0.661538481712341;0.280769228935242 0.107692308723927 0.653846144676208;0.269230782985687 0.0923076942563057 0.64615386724472;0.25769230723381 0.0769230797886848 0.638461589813232;0.246153846383095 0.0615384615957737 0.6307692527771;0.234615385532379 0.0461538471281528 0.623076915740967;0.223076924681664 0.0307692307978868 0.615384638309479;0.211538463830948 0.0153846153989434 0.607692360877991;0.200000002980232 0 0.600000023841858]);
%         colormap([0.400000005960464 1 1;0.436363637447357
%         0.981818199157715 1;0.47272726893425 0.963636338710785 1;0.509090900421143 0.9454545378685 1;0.545454561710358 0.927272737026215 1;0.581818163394928 0.909090936183929 1;0.618181824684143 0.890909075737 1;0.654545485973358 0.872727274894714 1;0.690909087657928 0.854545474052429 1;0.727272748947144 0.836363673210144 1;0.763636350631714 0.818181812763214 1;0.800000011920929 0.800000011920929 1;0.788461565971375 0.784615397453308 0.992307662963867;0.776923060417175 0.769230782985687 0.984615385532379;0.765384614467621 0.753846168518066 0.976923108100891;0.753846168518066 0.738461554050446 0.969230771064758;0.742307722568512 0.723076939582825 0.961538434028625;0.730769217014313 0.707692325115204 0.953846156597137;0.719230771064758 0.692307710647583 0.946153879165649;0.707692325115204 0.676923096179962 0.938461542129517;0.696153879165649 0.661538481712341 0.930769205093384;0.68461537361145 0.64615386724472 0.923076927661896;0.673076927661896 0.6307692527771 0.915384650230408;0.661538481712341 0.615384638309479 0.907692313194275;0.650000035762787 0.600000023841858 0.899999976158142;0.638461530208588 0.584615409374237 0.892307698726654;0.626923084259033 0.569230794906616 0.884615421295166;0.615384638309479 0.553846180438995 0.876923084259033;0.603846192359924 0.538461565971375 0.8692307472229;0.592307686805725 0.523076951503754 0.861538469791412;0.580769240856171 0.507692337036133 0.853846192359924;0.569230794906616 0.49230769276619 0.846153855323792;0.557692289352417 0.476923078298569 0.838461518287659;0.546153843402863 0.461538463830948 0.830769240856171;0.534615397453308 0.446153849363327 0.823076963424683;0.523076951503754 0.430769234895706 0.81538462638855;0.511538445949554 0.415384620428085 0.807692289352417;0.5 0.400000005960464 0.800000011920929;0.488461554050446 0.384615391492844 0.792307734489441;0.476923078298569 0.369230777025223 0.784615397453308;0.465384632349014 0.353846162557602 0.776923060417175;0.453846156597137 0.338461548089981 0.769230782985687;0.442307710647583 0.32307693362236 0.761538505554199;0.430769234895706 0.307692319154739 0.753846168518066;0.419230788946152 0.292307704687119 0.746153831481934;0.407692313194275 0.276923090219498 0.738461554050446;0.396153837442398 0.261538475751877 0.730769276618958;0.384615391492844 0.246153846383095 0.723076939582825;0.373076915740967 0.230769231915474 0.715384602546692;0.361538469791412 0.215384617447853 0.707692325115204;0.349999994039536 0.200000002980232 0.700000047683716;0.338461548089981 0.184615388512611 0.692307710647583;0.326923072338104 0.169230774044991 0.68461537361145;0.31538462638855 0.15384615957737 0.676923096179962;0.303846150636673 0.138461545109749 0.669230818748474;0.292307704687119 0.123076923191547 0.661538481712341;0.280769228935242 0.107692308723927 0.653846144676208;0.269230782985687 0.0923076942563057 0.64615386724472;0.25769230723381 0.0769230797886848 0.638461589813232;0.246153846383095 0.0615384615957737 0.6307692527771;0.234615385532379 0.0461538471281528 0.623076915740967;0.223076924681664 0.0307692307978868 0.615384638309479;0.211538463830948 0.0153846153989434 0.607692360877991;0.200000002980232 0 0.600000023841858]);
        hold off
    end
    title({[tagName ' ' labelO labelO2 '    '];...
        ['polynomial-determined oxygen from temperature   ' ]; },'FontSize',20, 'FontWeight', 'bold')
    ylabel('Depth (m) ', 'FontSize',16, 'FontWeight', 'bold')
    xlabel('Date (PST) ', 'FontSize',16, 'FontWeight', 'bold')
    set(gca, 'XLim', [min(Seriesdate) max(Seriesdate)], 'YLim', [min(DepthTag*-1) max(DepthTag*-1)])
    set(gca, 'fontsize', 12, 'fontweight', 'bold')
    Hcbar = colorbar('location','EastOutside', 'LineWidth', 1);
    caxis([0 maxPoly]);
    xlabel(Hcbar,'Oxygen mL/L ', 'FontSize',16, 'FontWeight', 'bold');
    set(gca,'XTick', DeployDates + datenum(0, 0, 0, 8, 0, 0))
    datetick('x','mm/dd', 'keeplimits','keepticks')
    FigName = [tagName '_TimeSeries_TimeDepth_OxyProxy_' labelO '.pdf'];
    annotate_JS(Mfilename, gcf, FigName);
%     orient landscape % save
%     print('-dpdf', FigName);
    
    % set up percent of time
    inc = 0.25; % oxy increment
    oxybins = 0:inc:maxPoly;
    Oxybinned = hist(OXY, oxybins);
    Oxyperc = ((Oxybinned/sum(Oxybinned))*100);
    
    % plot oxygen histos
    figure
    bar(oxybins, Oxyperc)
    xlabel('Oxygen (mL/L) ','FontSize', 14, 'FontWeight', 'bold')
    ylabel('Percent ','FontSize', 14, 'FontWeight', 'bold')
    set(gca, 'fontsize', 12, 'fontweight', 'bold')
    set(gca, 'XLim', [0 maxO])
    
    colormap([0.839215695858002 0.909803926944733 0.850980401039124;0.72679740190506 0.822222232818604 0.754901945590973;0.614379107952118 0.734640538692474 0.658823549747467;0.501960813999176 0.647058844566345 0.562745094299316;0.389542490243912 0.559477150440216 0.466666668653488;0.27712419629097 0.471895426511765 0.37058824300766;0.164705887436867 0.384313732385635 0.274509817361832;0.701960802078247 0.780392169952393 1;0.696568667888641 0.770027995109558 1;0.691176474094391 0.759663879871368 1;0.685784339904785 0.749299705028534 1;0.680392146110535 0.738935589790344 1;0.675000011920929 0.72857141494751 1;0.669607877731323 0.71820729970932 1;0.664215683937073 0.707843124866486 1;0.658823549747467 0.697479009628296 1;0.653431415557861 0.687114834785461 1;0.648039221763611 0.676750719547272 1;0.642647087574005 0.666386544704437 1;0.637254893779755 0.656022429466248 1;0.631862759590149 0.645658254623413 1;0.626470625400543 0.635294139385223 1;0.621078431606293 0.624929964542389 1;0.615686297416687 0.614565849304199 1;0.610294103622437 0.604201674461365 1;0.604901969432831 0.593837559223175 1;0.599509835243225 0.583473384380341 1;0.594117641448975 0.573109269142151 1;0.588725507259369 0.562745094299316 1;0.583333373069763 0.552380979061127 1;0.577941179275513 0.542016804218292 1;0.572549045085907 0.531652688980103 1;0.567156851291656 0.521288514137268 1;0.561764717102051 0.510924398899078 1;0.556372582912445 0.500560224056244 1;0.550980389118195 0.490196079015732 1;0.545588254928589 0.47983193397522 1;0.540196061134338 0.469467788934708 1;0.534803926944733 0.459103643894196 1;0.529411792755127 0.448739498853683 1;0.524019598960876 0.438375353813171 1;0.518627464771271 0.428011208772659 1;0.513235330581665 0.417647063732147 1;0.507843136787415 0.407282918691635 1;0.502451002597809 0.396918773651123 1;0.497058838605881 0.386554628610611 1;0.491666674613953 0.376190483570099 1;0.486274510622025 0.365826338529587 1;0.480882376432419 0.355462193489075 1;0.475490212440491 0.345098048448563 1;0.470098048448563 0.334733903408051 1;0.464705884456635 0.324369758367538 1;0.459313720464706 0.314005613327026 1;0.453921586275101 0.303641468286514 1;0.448529422283173 0.293277323246002 1;0.443137258291245 0.28291317820549 1;0.437745094299316 0.272549033164978 1;0.432352960109711 0.262184888124466 1;0.426960796117783 0.251820743083954 1;0.421568632125854 0.241456583142281 1;0.416176468133926 0.231092438101768 1;0.410784333944321 0.220728293061256 1;0.405392169952393 0.210364148020744 1;0.400000005960464 0.200000002980232 1]);
    title({[tagName ' percent time-at-oxygen (polynomial-based) ' ]; [labelO ' ' labelO2 ' mL/L ']}, 'fontsize', 16, 'fontweight', 'bold');
    FigName = [tagName '_TimeSeries_TimeDepth_OxyProxyHistos' num2str(inc*100) labelO '.pdf'];
    annotate_JS(Mfilename, gcf, FigName);
%     orient landscape % save
%     print('-dpdf', [dir1 FigName]);
    
    % boxplots of oxygen
    figure
    boxplot(OXY, 'colors', 'k', 'symbol', '.k', 'outliersize', 5)
    hold on
 
    xlabel(['Tag ' tagName], 'FontSize',16, 'FontWeight', 'bold')
    ylabel('Oxygen (mL/L) ', 'FontSize',16, 'FontWeight', 'bold')
    title({[tagName ' percent time-at-oxygen (polynomial-based) ' ]; ['boxplot ' labelO ' ' labelO2]}, 'fontsize', 16, 'fontweight', 'bold');
    set(gca, 'fontsize', 12, 'fontweight', 'bold')
    set(gca, 'YLim', [0 maxO])
    FigName = [tagName '_TimeSeries_TimeDepth_OxyProxyBoxplot' labelO '.pdf'];
    annotate_JS(Mfilename, gcf, FigName);
%     orient landscape % save
%     print('-dpdf', [dir1 FigName]);
end

save([CompareTagDir tagName '_oxy.mat'], 'OxygenTagProxy')

%%

disp('Completed plotOxygenProxy.m')
% ===== EOF [plotOxygenProxy.m] ======
